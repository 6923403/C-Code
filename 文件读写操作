#include <QFileDialog>
#include <QMessageBox>
#include <QFile>
#include <QTextCodec>

//点击按钮 选取文件

    connect(ui -> pushButton, &QPushButton::clicked, [=]()

    {

        QString path = QFileDialog::getOpenFileName(this, "打开文件", "/home/then/下载");

        if(path.isEmpty())

        {

            QMessageBox::warning(this, "警告", "打开失败");

        }

        else

        {

            //将路径放入到lineEdit中

            ui -> lineEdit -> setText(path);

            //读取文件

            //QFile 默认支持UTF-8

//            QTextCodec * codec = QTextCodec::codecForName("gbk");

            QFile file(path); //参数路径名称

            //指定打开方式 只读

            file.open(QIODevice::ReadOnly);

          // file.open(QFileDevice::ReadOnly);

            QByteArray array;

            array = file.readAll();

//            while(!file.atEnd())

//            {

//              array += file.readLine();

//            }

            //设置到文本编辑框中

            ui -> textEdit -> setText(array);

            file.close();

            //读GBK

  //          ui -> textEdit -> setText(codec -> toUnicode(array));

            //写文件 重新指定打开方式

            file.open(QFileDevice::Append);

            file.write("测试一下");

            file.close();

        }

    });
